# Serial Update Tool

The serial update tool, dfu.py, is a Python script which performs firmware application updates via a wired serial connection to the Rigado Secure Bootloader.  For the most part, this script is very similar to dfu.js in terms of how it operates.  Both unencrypted and encrypted firmware updates are supported.  In addition, this script can program a new private key, change the existing private key, and update the MAC address if necessary.

## Usage
```
dfu.py [-h] [-M NEWMAC] [-K NEWKEY] [-k OLDKEY] [-s SERIAL] [-b BAUD]
        [-i INFILE] [-v] [-vv VVERBOSE]

RigDFU2 Serial Updater

required arguments:
  -s, --serial is always required
  -i, --infile is required when performing a firmware update
  -k, --oldkey and -K, --newkey are both required when either setting a secure key initially or updated the key
  
available arguments:
  -h, --help            show this help message and exit
  -M NEWMAC, --newmac NEWMAC
                        new MAC address (6 octets, big-endian)
  -K NEWKEY, --newkey NEWKEY
                        new key (16 bytes, big-endian)
  -k OLDKEY, --oldkey OLDKEY
                        old key (16 bytes, big-endian)
  -s SERIAL, --serial SERIAL
                        serial port
  -b BAUD, --baud BAUD  serial baudrate [115200]
  -i INFILE, --infile INFILE
                        packed data binary file to upload
  -v, --verbose         enable verbose level 1
  -vv VVERBOSE, --vverbose VVERBOSE
                        set verbose level (1,2)

```

* SERIAL and INFILE must always be specified unless the key is being updated in which case INFILE is not needed.

* INFILE must be a binary file as generated by genimage.  If the bootloader is secured, then INFILE must be a binary generated by signimage.

* The default baud rate is 115200.  If other baud rates are needed, contact Rigado to get a custom bootloader version with a different baud rate.

* If you want to disable security, then -K, --newkey must be specified with FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF.

## Examples

### Linux/OS X

```
  python3 dfu.py -s /dev/tty.usbserial-DN002U6U -i blinky.bin
```

### Windows

```
  C:\Python34\python dfu.py -s COM26 -i blinky.bin
```
