BLE DFU for Linux and OSX
=========================

This tool transfers firmware images to the RigDFU bootloader via BLE,
using the Javascript library "noble":
  https://github.com/sandeepmistry/noble

Setup
-----

Install packages:

    sudo apt-get install nodejs node-gyp npm \
                         bluetooth bluez-utils libbluetooth-dev

On Ubuntu 12.04, you might need to get a newer nodejs with:

    sudo apt-get install python-software-properties
    sudo add-apt-repository ppa:chris-lea/node.js
    sudo apt-get install nodejs

On OS X with Brew:

    sudo brew install nodejs
    sudo brew install npm

Install required Node packages:

    npm install

Those will end up in the `node_modules/` subdirectory of your current dir.

Running
-------

You need to run the tools with sudo for now.

To just monitor BLE device advertisements:

    sudo ./monitor.js

To send new code:

    Usage: dfu [options] <data.bin>

    Options:

      -h, --help       output usage information
      -V, --version    output the version number
      -m, --mac <MAC>  Only update device with this MAC
      <data.bin>       Packed data file to send

* `data.bin` is a raw binary file containing the header, encryption
   info, and image data, as generated by the `genimage` tool.

* If the target device is configured with an encryption key, th output
  of `genimage` must have been encrypted and signed with `signimage`
  for that particular key.

* Use `--mac` to limit the updating to a device with a particular MAC.
  If not specified, any device with the right service UUID and name (RigDfu)
  will be updated.
